import webbrowser
import time
import pyperclip
import tkinter
import pyautogui
import subprocess
import sys
import os
import pywinauto
from pynput.keyboard import Key, Controller

# pyinstaller -w -F -i "C:\Users\Chw\Desktop\PROG\web coding\playin\boty\launcher\bloon.ico" launcher.py

botCode = 'bot&&bot.stop();{const t=(t,e=null,n=null)=>{e&&(t.id=controllerId),n&&t.classList.add(...n)},e=(t,e)=>{const n=t.classList.contains(\"btn-on\");return t.classList.toggle(\"btn-on\"),bot.text[e](n),n},n=(t,e,n)=>{var i=new Blob([t],{type:n});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(i,e);else{var s=document.createElement(\"a\"),o=URL.createObjectURL(i);s.href=o,s.download=e,document.body.appendChild(s),s.click(),setTimeout(function(){document.body.removeChild(s),window.URL.revokeObjectURL(o)},0)}},i=t=>0===Object.keys(t).length&&t.constructor===Object,s=t=>{const e=document.createElementNS(\"http://www.w3.org/2000/svg\",\"svg\"),n=document.createElementNS(\"http://www.w3.org/2000/svg\",\"path\");return n.setAttributeNS(null,\"d\",t),e.setAttributeNS(null,\"viewBox\",\"0 0 24 24\"),e.appendChild(n),e.classList.add(\"bot-svg-icon\"),e},o=document.createElement(\"span\");o.innerHTML=\'<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path d=\"M18 14.45v6.55h-16v-12h6.743l1.978-2h-10.721v16h20v-10.573l-2 2.023zm1.473-10.615l1.707 1.707-9.281 9.378-2.23.472.512-2.169 9.292-9.388zm-.008-2.835l-11.104 11.216-1.361 5.784 5.898-1.248 11.103-11.218-4.536-4.534z\"/></svg>\',o.classList.add(\"editBtn\",\"queue-icon\"),o.title=\"Edit message\";const a=document.createElement(\"span\");a.innerHTML=\'<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path d=\"M24 12l-6-5v4h-5v-5h4l-5-6-5 6h4v5h-5v-4l-6 5 6 5v-4h5v5h-4l5 6 5-6h-4v-5h5v4z\"/></svg>\',a.classList.add(\"bot-handle\",\"queue-icon\"),a.title=\"Move message\";const l=document.createElement(\"span\");l.innerHTML=\'<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M24 20.188l-8.315-8.209 8.2-8.282-3.697-3.697-8.212 8.318-8.31-8.203-3.666 3.666 8.321 8.24-8.206 8.313 3.666 3.666 8.237-8.318 8.285 8.203z\"/></svg>\',l.classList.add(\"bot-remove\",\"queue-icon\"),l.title=\"Delete message\";const r=document.createElement(\"span\");r.innerHTML=\'<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"18\" height=\"18\" viewBox=\"0 0 24 24\"><path d=\"M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm6 13h-5v5h-2v-5h-5v-2h5v-5h2v5h5v2z\"/></svg>\',r.classList.add(\"bot-temp-apply\"),r.title=\"Apply template\";const d=document.createElement(\"span\");d.innerHTML=\'<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path d=\"M12 18c1.657 0 3 1.343 3 3s-1.343 3-3 3-3-1.343-3-3 1.343-3 3-3zm0-9c1.657 0 3 1.343 3 3s-1.343 3-3 3-3-1.343-3-3 1.343-3 3-3zm0-9c1.657 0 3 1.343 3 3s-1.343 3-3 3-3-1.343-3-3 1.343-3 3-3z\"/></svg>\',d.classList.add(\"bot-temp-menu\");var bot={version:\"3.0\",botInterval:null,fakeTypeInterval:null,condInterval:null,rate:500,condRate:1e3,isRunning:!1,isAutoNext:!1,isFirstRun:!0,isQueueRunning:!0,isCondsRunning:!0,cp:{btn:\"\",btnAutoNext:\"\",panel:\"\",rateController:\"\",rateText:\"\",listForm:\"\",addToList:\"\",isHidden:!1,position:\"left\",init(){const e=document.querySelector(\"body\"),n=document.querySelector(\"#botPanel\");n&&n.remove();const o=document.querySelector(\"#sortablejs\");o&&o.remove();const a=document.createElement(\"script\");a.id=\"sortablejs\",a.src=\"https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js\",e.appendChild(a);const l=\"https://bloonbot.herokuapp.com/\",h=(t,e)=>msg={ifs:[t],thens:[e]};a.addEventListener(\"load\",()=>{Sortable.create(this.list,{group:\"botQueue\",animation:100,handle:\".bot-handle\",onEnd:t=>{const e=this.list.children,n=[];for(let t=0;t<e.length;t++)kid=e[t],n.push(kid.textContent);bot.text.mutateTextArr(n)}}),Sortable.create(this.condList,{group:\"botConds\",animation:100,handle:\".bot-handle\",onEnd:t=>{const e=this.condList.children,n=[];for(let t=0;t<e.length;t++){const i=e[t].children[0].textContent,s=e[t].children[1].textContent,o=h(i,s);n.push(o)}bot.text.mutateTextArr(n)}})}),this.all=document.createElement(\"div\"),this.all.id=\"bot--all-without-hide-btn\";const c=(t,e,n=\"div\")=>{this[t]=document.createElement(n);for(let n=0;n<e.length;n++){const i=e[n];b(i,t)}return this[t]},p=(t,e,n=\"all\",i=\"div\")=>(this[t]=c(t,e,i),b(t,n),this[t]),u=(t=[],e=\"\",n=\"div\")=>{if(el=document.createElement(n),e)if(\"string\"==typeof e)el.appendChild(document.createTextNode(e));else if(Array.isArray(e))for(let t=0;t<e.length;t++){const n=e[t];n&&el.appendChild(n)}else el.appendChild(e);return Array.isArray(t)?el.classList.add(...t):t&&el.classList.add(t),el},m=(t,e,n,i,s=!1,o=!1,a)=>{this[e]=document.createElement(\"input\"),this[e].type=\"checkbox\",this[e].checked=s,this[e].disabled=o,this[e].addEventListener(\"change\",t=>{const e=t.target.checked;n&&bot.text[n](e),a&&a(e)}),p(t,[e],\"all\",\"label\"),b(document.createTextNode(i),t)},g=t=>\"string\"==typeof t?this[t]:t,b=(t,e)=>{g(e).appendChild(g(t))},v=(e,n,i,o,a=\"all\")=>{if(this[e]=document.createElement(\"button\"),t(this[e],null,i),\"string\"==typeof n)this[e].appendChild(document.createTextNode(n));else{if(n.iconPath){const t=s(n.iconPath);this[e].appendChild(t)}n.text&&this[e].appendChild(document.createTextNode(n.text))}this[e].addEventListener(\"click\",o),b(e,a)};v(\"hideBtn\",\"HIDE\",[\"bot--btn\",\"bot--hide-btn\"],t=>{this.toggleHide()}),this.panel=document.createElement(\"div\"),this.panel.id=\"botPanel\",this.onOffSwitches=document.createElement(\"div\"),this.onOffSwitches.classList.add(\"onOffSwitches\"),v(\"btn\",\"ON/OFF\",[\"bot--btn\",\"bot--switch\"],t=>{bot.toggle()},\"onOffSwitches\"),v(\"queueBtn\",\"Queue\",[\"bot--btn\",\"btn-on\",\"onOffSpecific\"],t=>{bot.onOffSpecific(\"queue\")},\"onOffSwitches\"),v(\"conditsBtn\",\"Condits\",[\"bot--btn\",\"btn-on\",\"onOffSpecific\"],t=>{bot.onOffSpecific(\"conds\")},\"onOffSwitches\"),this.all.appendChild(this.onOffSwitches),m(\"loopDiv\",\"loopBox\",\"setLoop\",\"Loop/Repeat \",!0),m(\"replyDiv\",\"replyBox\",\"setReply\",\"Reply Mode \",!1,!1,t=>{this.replyAllDiv.classList.toggle(\"unactive\"),this.replyAllBox.disabled=!t}),m(\"replyAllDiv\",\"replyAllBox\",\"setReplyAll\",\"Send whole queue\",!1,!0),t(this.replyAllDiv,null,[\"bot--box-l2\",\"unactive\"]),m(\"randomDiv\",\"randomBox\",\"setRandom\",\"Random\"),m(\"realTypeDiv\",\"realTypeBox\",\"setRealType\",\"Real Typeâ„¢\"),m(\"fakeTypeDiv\",\"fakeTypeBox\",\"setFakeType\",\"Fake Typing\"),((t,e,n,i,s,o,a,l,r,d,h)=>{this[n]=document.createElement(\"span\"),this[n].innerHTML=i,this[s]=document.createElement(\"input\"),this[s].id=o,this[s].type=\"range\",this[s].min=a,this[s].max=l,this[s].value=r,this[s].step=d,this[s].addEventListener(\"input\",h),p(t,[n,s]),this.rate.id=e})(\"rate\",\"bot--rate\",\"rateText\",\'Send once/<span id=\"bot--rate-gauge\">\'+bot.rate+\"ms</span>\",\"rateController\",\"bot--rate-controller\",0,1e4,bot.rate,1,t=>{let e=t.target.value;bot.changeRate(e)}),setTimeout(()=>this.rateGauge=document.querySelector(\"#bot--rate-gauge\"),0),v(\"btnAutoNext\",\"Auto Next\",[\"bot--btn\",\"bot--auto-next\"],t=>{bot.toggleAutoNext()}),this.btnAutoNext.title=\"If enabled, bot will automatically start another chat when other chatter disconnects.\",v(\"conditsSwitch\",\"conditionals >\",[\"bot--condits-switch\",\"bot--btn\"],this.handleConditsSwitch.bind(this)),this.beginLabel=u(\"begin-label\",\"Start chat with: \",\"span\"),this.beginInput=document.createElement(\"input\"),this.beginInput.classList.add(\"begin\"),this.beginInput.placeholder=\"Message\",p(\"beginDiv\",[\"beginLabel\",\"beginInput\"]),this.beginDiv.classList.add(\"begin-div\");p(\"tempCondForm\",[\"conditsSwitch\"]),t(this.tempCondForm,null,[\"bot--container\"]),this.condIfInput=document.createElement(\"input\"),this.condIfInput.placeholder=\"can be RegEx (eg. /regex/)\",this.condIfInput.required=!0,this.condIfLabel=document.createTextNode(\"IF: \"),this.condThenInput=document.createElement(\"input\"),this.condThenInput.required=!0,this.condThenLabel=document.createTextNode(\"THEN: \"),p(\"condIfDiv\",[\"condIfLabel\",\"condIfInput\"]),p(\"condThenDiv\",[\"condThenLabel\",\"condThenInput\"]),v(\"removeCondsBtn\",\"X\",[\"bot--btn\"],t=>{bot.text.removeQueue()}),this.removeCondsBtn.type=\"button\",this.removeCondsBtn.title=\"Clear list of conditionals.\";const f=document.createElement(\"input\");f.type=\"submit\",f.classList.add(\"necessary_submit\"),p(\"condControl\",[\"condIfDiv\",\"condThenDiv\",\"removeCondsBtn\",f]),this.condControl.classList.add(\"bot--list-control\"),this.condList=document.createElement(\"div\"),this.condList.classList.add(\"bot--list\"),this.condList.addEventListener(\"mouseup\",t=>{x(t.target)}),p(\"condForm\",[\"condControl\",\"condList\"],\"all\",\"form\"),this.condForm.classList.add(\"cond-form\",\"unactive-form\"),this.condForm.addEventListener(\"submit\",t=>{t.preventDefault();const e=this.condIfInput.value,n=this.condThenInput.value;bot.text.addMessage(h(e,n)),this.condIfInput.value=this.condThenInput.value=\"\"}),this.addToList=document.createElement(\"input\"),this.addToList.placeholder=\"Add to message queue\",this.addToList.setAttribute(\"style\",\"width: 80%\"),v(\"resetQueueBtn\",\"R\",[\"bot--btn\"],t=>{bot.text.reset()}),this.resetQueueBtn.title=\"Start from first message.\",v(\"removeQueueBtn\",\"X\",[\"bot--btn\"],t=>{bot.text.removeQueue()}),this.removeQueueBtn.id=\"bot--remove-queue\",this.removeQueueBtn.title=\"Clear the queue of messages.\",this.upperDiv=document.createElement(\"div\"),this.upperDiv.classList.add(\"bot--list-control\"),this.upperDiv.appendChild(this.addToList),this.upperDiv.appendChild(this.resetQueueBtn),this.upperDiv.appendChild(this.removeQueueBtn),this.list=document.createElement(\"div\"),this.list.classList.add(\"bot--list\");let w=null;e.addEventListener(\"mousedown\",t=>{t.target.classList.contains(\"editInput\")||(t.target.closest(\".editBtn\")||bot.text.updateListItem(w),w&&(bot.text.updateListItem(w),w=null))});const x=t=>{const e=t.closest(\".bot--queue-item\");t.closest(\".editBtn\")?setTimeout(()=>{const n=e.classList.contains(\"bot--cond-item\"),i=e.dataset.id,s=n?bot.text.condArr[i]:bot.text.textArr[i],o=document.createElement(\"form\"),a=document.createElement(\"input\");let l=null,r=null,d=null;n?((r=t.closest(\".if-part\"))?(l=\"ifs\",d=s.ifs):(r=t.closest(\".then-part\"),l=\"thens\",d=s.thens),a.value=d[0]):(r=e,a.value=s),a.classList.add(\"editInput\"),o.appendChild(a),r.innerHTML=\"\",r.appendChild(o),w=i,a.focus(),o.addEventListener(\"submit\",t=>{t.preventDefault();const e=a.value;let o=e;if(n){let t={...s};t[l][0]=e,o=t}bot.text.edit(i,o),w=null})},0):t.closest(\".bot-remove\")&&bot.text.removeMessage(e.dataset.id)};this.list.addEventListener(\"click\",t=>{x(t.target)}),((t,e,n,i,s,o)=>{this[t]=document.createElement(\"div\"),this[t].classList.add(...e),this[n]=document.createElement(\"select\");for(let t=0;t<i.length;t++){const e=document.createElement(\"option\");e.appendChild(document.createTextNode(i[t])),e.value=i[t],this[n].appendChild(e)}this[t].appendChild(document.createTextNode(s)),this[t].appendChild(this[n]),this[n].addEventListener(\"change\",o)})(\"modes\",[\"bot--modes\"],\"selectMode\",[\"NONE\",\"increment\",\"parrot\"],\"Mode \",t=>{bot.text.setMode(t.target.value)}),p(\"templatesModesDiv\",[\"modes\"]),this.templatesModesDiv.classList.add(\"templates-modes-div\"),p(\"listForm\",[\"templatesModesDiv\",\"upperDiv\",\"list\"],\"all\",\"form\"),this.listForm.addEventListener(\"submit\",t=>{t.preventDefault();const e=this.addToList.value;bot.text.addMessage(e),this.addToList.value=\"\"});const y=()=>{const t=this.impSeparation.value,e=this.importFile.files,n=this.importInput.value,i=n||e;bot.text.import(t,i)};this.expImp=document.createElement(\"div\"),this.exportDiv=document.createElement(\"div\"),this.importDiv=document.createElement(\"form\"),this.importDiv.classList.add(\"bot--import-div\"),this.importTop=document.createElement(\"div\"),this.importTop.classList.add(\"import-top\"),this.importDiv.addEventListener(\"submit\",t=>{t.preventDefault(),y()}),this.expImp.classList.add(\"bot--expimp\"),v(\"exportBtn\",\"< Export >\",[\"bot--btn\",\"bot--export\"],t=>{const e=this.expName.value;bot.text.export(e)},\"exportDiv\"),this.exportBtn.title=\"Export to file.\",v(\"importBtn\",\"> Import <\",[\"bot--btn\",\"bot--import\"],t=>{},\"importTop\"),this.importBtn.title=\"Import from text or file.\",this.expName=document.createElement(\"input\"),this.expName.placeholder=\"file name\",this.expName.id=\"bot--expName\",this.impSeparation=document.createElement(\"input\"),this.impSeparation.placeholder=\"sep.\",this.impSeparation.id=\"bot--impSep\",this.impSeparation.title=\'(ONLY for importing text) Separation - eg. \",\" will split \"i, like, pepper\" to messages \"i\", \"like\" and \"pepper\"\',this.importFile=document.createElement(\"input\"),this.importFile.classList.add(\"import-file\"),this.importFile.type=\"file\",this.exportDiv.classList.add(\"bot--export-div\"),this.exportDiv.appendChild(this.expName),this.importTop.appendChild(this.impSeparation),this.importTop.appendChild(this.importFile);const L=(t,e=!1)=>{const n=u(\"\",t,\"span\"),i=u(\"\",\"\",\"input\");return i.required=e,{input:i,container:u(\"input-container\",[n,i])}},T=(t,e,n=!1)=>{if(!t.classList.contains(\"result-msg\")){const e=u(\"result-msg\");t.appendChild(e),t=e}t.textContent=e,n?t.classList.remove(\"wrong\"):t.classList.add(\"wrong\")};(()=>{this.uploadSettings={private:!1};const t=L(\"Template name: \",!0),e=u(\"result-msg\"),n=u(\"private-div\",[],\"label\");m(n,\"privateBox\",null,\"Private\",!1,!1,t=>{this.uploadSettings.private=t});const i=u(\"upload-content\",[t.container,n,e],\"form\"),s=T.bind(null,e);v(\"uploadBtn\",\"\",[\"bot--btn\",\"icon-btn\",\"upload-btn\"],t=>{M(t,this.uploadWindow,[\".bot-window\",\".template-menu\"])},\"exportDiv\"),this.uploadBtn.innerHTML=\'<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path d=\"M16 16h-3v5h-2v-5h-3l4-4 4 4zm3.479-5.908c-.212-3.951-3.473-7.092-7.479-7.092s-7.267 3.141-7.479 7.092c-2.57.463-4.521 2.706-4.521 5.408 0 3.037 2.463 5.5 5.5 5.5h3.5v-2h-3.5c-1.93 0-3.5-1.57-3.5-3.5 0-2.797 2.479-3.833 4.433-3.72-.167-4.218 2.208-6.78 5.567-6.78 3.453 0 5.891 2.797 5.567 6.78 1.745-.046 4.433.751 4.433 3.72 0 1.93-1.57 3.5-3.5 3.5h-3.5v2h3.5c3.037 0 5.5-2.463 5.5-5.5 0-2.702-1.951-4.945-4.521-5.408z\"/></svg>\';const o=u(\"top-bar\",\"Upload template\");p(\"uploadWindow\",[o,i],\"uploadBtn\").classList.add(\"upload-window\",\"bot-window\",\"off\"),v(\"closeUpload\",\"X\",[\"bot--btn\"],t=>{this.uploadWindow.classList.add(\"off\")},o),this.uploadTemplate=((t,e=!0)=>{fetch(l+\"templates\",{method:\"POST\",credentials:\"include\",headers:{\"Content-type\":\"application/json\"},body:JSON.stringify(t)}).then(async t=>{const n=await t.json();e&&(this.uploadTemp.classList.remove(\"inactive-btn\"),t.ok?s(\"Template created!\",!0):n&&n.msg?s(n.msg):s(\"Unknown error\"))}).catch(t=>{e&&(this.uploadTemp.classList.remove(\"inactive-btn\"),s(t))})}),v(\"uploadTemp\",\"Upload\",[\"bot--btn\",\"upload-temp\"],e=>{e.preventDefault();const n=bot.text.packData(),i=t.input.value;if(!i)return s(\"You have to name your template.\");this.uploadTemp.classList.add(\"inactive-btn\"),this.uploadTemplate({name:i,private:this.uploadSettings.private,template:n})},i)})(),(()=>{this.searchParams={},this.editSearchParams=(t=>{if(t.myTemplates)if(\"toggle\"===t.myTemplates){const e=!this.myTemplates.classList.toggle(\"disabled-btn\");t.myTemplates=e?1:0}else t.myTemplates?this.myTemplates.classList.remove(\"disabled-btn\"):this.myTemplates.classList.add(\"disabled-btn\");this.searchParams={...this.searchParams,...t}}),this.fetchTemplates=((t=!1)=>{if(!this.searchWindow.classList.contains(\"off\")||t){this.templatesResult.innerHTML=\"\",this.templatesResult.appendChild(u(\"bot-loading\",\"Loading templates...\"));const t=(t,e)=>{if(t){const n=u(\"template-peek\"),i=u(\"template-name\",\"\",\"div\"),o=t.name;i.textContent=o||\"unknown\";const a=u(\"template-author\",\" by \"+(t.author?t.author.name:\"unknown\"),\"span\"),l=u(\"template-author\",\", \"+t.timestamp,\"span\");if(t.template){const e=t.template.textArr;let i=e[0];for(let t=1;t<e.length&&!(t>5);t++){i=i+\", \"+e[t]}i=document.createTextNode(i),n.appendChild(i)}const h=this.user.login===t.author.name||\"all\"===this.user.permissions?d.cloneNode(!0):null,c=u(\"template-top\",[h,i,a,l,r.cloneNode(!0)]),p=u(\"template\",[c,n]);if(t.private){let t=s(\"M18 10v-4c0-3.313-2.687-6-6-6s-6 2.687-6 6v4h-3v14h18v-14h-3zm-10 0v-4c0-2.206 1.794-4 4-4s4 1.794 4 4v4h-8z\");i.appendChild(t),p.classList.add(\"private\")}p.dataset.id=t._id,e.appendChild(p)}},e=new URL(l+\"templates\");i(this.searchParams)||(e.search=new URLSearchParams(this.searchParams).toString()),fetch(e,{credentials:\"include\"}).then(async e=>{const n=await e.json();this.templatesResult.innerHTML=\"\";const i=document.createDocumentFragment();if(n.length)for(item of n)t(item,i);else{const t=u(\"bot-no-data\",\"Nothing in here, but You can change it :)\");i.appendChild(t)}this.templatesResult.appendChild(i)}).catch(t=>{this.templatesResult.innerHTML=\"\",T(this.templatesResult,t)})}}),v(\"searchBtn\",\"\",[\"bot--btn\",\"icon-btn\",\"search-btn\"],t=>{t.preventDefault(),M(t,this.searchWindow,[\".search-window\",\".template-menu\"])&&this.fetchTemplates()},\"importTop\"),this.searchBtn.innerHTML=\'<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path d=\"M23.822 20.88l-6.353-6.354c.93-1.465 1.467-3.2 1.467-5.059.001-5.219-4.247-9.467-9.468-9.467s-9.468 4.248-9.468 9.468c0 5.221 4.247 9.469 9.468 9.469 1.768 0 3.421-.487 4.839-1.333l6.396 6.396 3.119-3.12zm-20.294-11.412c0-3.273 2.665-5.938 5.939-5.938 3.275 0 5.94 2.664 5.94 5.938 0 3.275-2.665 5.939-5.94 5.939-3.274 0-5.939-2.664-5.939-5.939z\"/></svg>\',p(\"topBar\",[]).classList.add(\"top-bar\"),v(\"myTemplates\",\"My templates\",[\"bot--btn\",\"disabled-btn\",\"bot-unshown\"],t=>{this.editSearchParams({myTemplates:\"toggle\"}),this.fetchTemplates()});const t=u(\"top-bar\",[this.myTemplates]),n=p(\"search\",[],\"topBar\",\"input\");n.placeholder=\"Search for templates...\",n.addEventListener(\"input\",t=>{this.editSearchParams({search:n.value}),this.fetchTemplates()}),v(\"searchClose\",\"X\",[\"close\",\"bot--btn\"],t=>{this.searchWindow.classList.add(\"off\")},\"topBar\"),p(\"searchWindow\",[\"topBar\",t]),p(\"templatesResult\",[],\"searchWindow\"),this.templatesResult.classList.add(\"templates-result\");const o=u(\"bot-loading\",\"Loading templates...\");this.templatesResult.appendChild(o),this.searchWindow.classList.add(\"search-window\",\"bot-window\",\"off\"),this.searchBtn.appendChild(this.searchWindow);const a=u(\"result-msg\"),h=T.bind(null,a);this.templatesResult.addEventListener(\"click\",t=>{const e=t.target.closest(\".template\");if(h(\"\"),e&&e.appendChild(a),!e)return;const n=e.dataset.id;let i;t.target.closest(\".bot-temp-apply\")?c(n):(i=t.target.closest(\".bot-temp-menu\"))&&(t.target.closest(\".template-menu\")?(b(),t.target.classList.contains(\"option-delete\")?fetch(l+\"templates/\"+n,{method:\"DELETE\",credentials:\"include\"}).then(async t=>{const e=await t.json();t.ok?this.fetchTemplates():e.msg?h(e.msg):h(\"Cannot delete - unknown error\")}).catch(t=>{h(t)}):t.target.classList.contains(\"option-edit\")&&this.updateTemplate(\"init\",{el:e,id:n}),g=!1):f(i,n))});const c=t=>new Promise((e,n)=>{fetch(l+\"templates/\"+t).then(async t=>{const i=await t.json();t.ok?(bot.text.import(\"\",i.template,!0),h(\"Template applied!\",!0),e(\"success\")):(i.msg?h(i.msg):h(\"Cannot apply template - unknown error\"),n(\"wrong\"))}).catch(t=>{h(t),n(t)})});this.updateTemplate=((t,e=this.user.updatingTemplate)=>{let n,i={mode:t};const s=e.id||e._id;\"init\"===t?n=c(s):\"save\"===t&&(tempData=bot.text.packData(),i.template=tempData,setTimeout(t=>this.fetchTemplates(),1e3)),fetch(l+\"templates/\"+s,{method:\"PUT\",credentials:\"include\",headers:{\"Content-type\":\"application/json\"},body:JSON.stringify(i)}).then(async i=>{Promise.all([i.json(),n]).then(n=>{const i=n[0];if(\"init\"===t)if(i&&i.name)this.user.setUpdating({name:i.name,...e}),h(\"Updating \"+i.name,!0);else{const t=i.msg||\"Unknown error\";h(t)}else if(\"cancel\"===t||\"save\"===t){this.updateCancel.classList.remove(\"inactive-btn\"),this.updateSave.classList.remove(\"inactive-btn\"),this.user.setUpdating(null);const t=i.msg||\"Updating cancelled\";h(t,!0)}}).catch(t=>{this.user.setUpdating(null),h(t)})}).catch(t=>{this.user.setUpdating(null),h(t)})}),setTimeout(()=>{const t=u(\"temp-update-label\",\"Updating template:\");this.tempUpdatingName=u(\"temp-update-name\",\"-\");const e=u(\"\",[t,this.tempUpdatingName]);p(\"updateToolbar\",[e]),this.updateToolbar.classList.add(\"update-toolbar\"),v(\"updateCancel\",{text:\"Cancel\",iconPath:\"M24 20.188l-8.315-8.209 8.2-8.282-3.697-3.697-8.212 8.318-8.31-8.203-3.666 3.666 8.321 8.24-8.206 8.313 3.666 3.666 8.237-8.318 8.285 8.203z\"},[\"bot--btn\"],t=>{this.updateCancel.classList.add(\"inactive-btn\"),this.updateTemplate(\"cancel\")},\"updateToolbar\"),v(\"updateSave\",{text:\"Save\",iconPath:\"M20.285 2l-11.285 11.567-5.286-5.011-3.714 3.716 9 8.728 15-15.285z\"},[\"bot--btn\"],t=>{this.updateSave.classList.add(\"inactive-btn\"),this.updateTemplate(\"save\")},\"updateToolbar\")},0);let m=!1,g=!1;const b=()=>{m&&m.remove()},f=(t,e)=>{if(b(),e!==g){const n=u([\"template-option\",\"option-delete\"],\"Delete\"),i=u([\"template-option\",\"option-edit\"],\"Edit\");m=u(\"template-menu\",[i,n]),t.appendChild(m),g=e}else g=!1};e.addEventListener(\"click\",t=>{m&&(t.target.closest(\".bot-temp-menu\")||t.target.closest(\".template-menu\")||(g=!1,m.remove()))})})(),this.importDiv.appendChild(this.importTop),this.importInput=document.createElement(\"textarea\"),this.importInput.placeholder=\"Paste or type in some text to import\",this.importDiv.appendChild(this.importInput),this.expImp.appendChild(this.exportDiv),this.expImp.appendChild(this.importDiv),this.all.appendChild(this.expImp),this.panel.appendChild(this.hideBtn),v(\"sideSwitch\",\"<|>\",[\"top-btns\",\"bot--btn\",\"icon-btn\",\"side-switch\"],t=>{this.position=this.panel.classList.toggle(\"right\")},this.panel),this.sideSwitch.title=\"Change bot position (left/right)\",this.sideSwitch.innerHTML=\'<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path d=\"M6 13v4l-6-5 6-5v4h3v2h-3zm9-2v2h3v4l6-5-6-5v4h-3zm-4-6v14h2v-14h-2z\"/></svg>\';(()=>{v(\"userBtn\",\"Sign in/Register\",[\"top-btns\",\"bot--btn\",\"icon-btn\"],t=>{M(t,this[C],\".bot-window\")},this.panel),this.userBtn.title=\"Sign in/Register\",this.userBtn.innerHTML=\'<svg xmlns=\"https://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path d=\"M8 9v-4l8 7-8 7v-4h-8v-6h8zm2-7v2h12v16h-12v2h14v-20h-14z\"/></svg>\';const t=L(\"Login: \",1),e=L(\"Password: \",1);e.input.type=\"password\",v(\"closeSign\",\"X\",[\"bot--btn\"],t=>{this.signWindow.classList.add(\"off\")});const n=u(\"result-msg\"),i=T.bind(null,n),s=u(\"\",[t.container,e.container,n]),o=u([\"sign-title\"],\"Sign in\"),a=u([\"sign-title\",\"active\"],\"Register\"),r=u([\"bot--container\",\"sign-switch\"],[a,o]);let d=\"up\";r.addEventListener(\"click\",t=>{i(\"\"),o.classList.toggle(\"active\"),a.classList.toggle(\"active\"),\"up\"===d?(d=\"in\",this.signBtn.textContent=\"Sign in\"):(d=\"up\",this.signBtn.textContent=\"Register\")});const h=u(\"top-bar\",[r,this.closeSign]);c(\"signWindow\",[h,s]),this.signWindow.classList.add(\"sign-window\",\"bot-window\"),this.signWindow.title=\"\",v(\"signBtn\",\"Register\",[\"bot--btn\",\"sign-btn\"],n=>{i(\"\");const s={login:t.input.value,password:e.input.value};s.login&&s.password?(this.signBtn.classList.add(\"inactive-btn\"),fetch(l+\"users/\"+(\"up\"===d?\"register\":\"signin\"),{method:\"POST\",credentials:\"include\",headers:{\"Content-type\":\"application/json\"},body:JSON.stringify(s)}).then(async t=>{const e=await t.json();t.ok?e.login?(i(\"\"),this.user.setLoggedState(e)):i(e.msg,!0):i(e.msg),this.signBtn.classList.remove(\"inactive-btn\")}).catch(t=>{i(t),this.signBtn.classList.remove(\"inactive-btn\")})):i(\"Please fill in fields.\")},this.signWindow),this.userBtn.appendChild(this.signWindow)})();let C=\"signWindow\",k=\"userWindow\";const S=bot.cp;this.user={login:null,permissions:\"standard\",updatingTemplate:{},isLoggedIn:function(){return Boolean(this.login)},setUpdating:function(t){t&&t.name?(this.updatingTemplate=t,S.tempUpdatingName.textContent=t.name,S.panel.classList.add(\"editMode\")):(this.updatingTemplate=null,S.tempUpdatingName&&(S.tempUpdatingName.textContent=\"-\"),S.panel.classList.remove(\"editMode\"))},setLoggedState:function(t){t&&t.login?(this.login=t.login,this.permissions=t.permissions,this.autoSave=t.autoSave,this.setUpdating(t.updatingTemplate),setTimeout(()=>{if(this.autoSave){const t=this.autoSave,e=t.template,n=bot.text.packData();e.textArr!==n.textArr&&e.condArr!==n.condArr&&confirm(\"Do you want to load autosave from \"+t.timestamp+\"?\")&&bot.text.import(null,t.template,!0)}},500),t.updatingTemplate&&S.updateTemplate(\"init\")):(this.login=null,this.permissions=null,this.autoSave=null,this.setUpdating(null)),z()}};const z=()=>{if(this.myTemplates.classList.toggle(\"bot-unshown\"),this.user.login){R(),k=\"signWindow\",C=\"userWindow\",B(this.user.login),this.userBtn.querySelector(\"svg\").innerHTML=\'<path d=\"M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm7.753 18.305c-.261-.586-.789-.991-1.871-1.241-2.293-.529-4.428-.993-3.393-2.945 3.145-5.942.833-9.119-2.489-9.119-3.388 0-5.644 3.299-2.489 9.119 1.066 1.964-1.148 2.427-3.393 2.945-1.084.25-1.608.658-1.867 1.246-1.405-1.723-2.251-3.919-2.251-6.31 0-5.514 4.486-10 10-10s10 4.486 10 10c0 2.389-.845 4.583-2.247 6.305z\"/>\'}else{R(),C=\"signWindow\",k=\"userWindow\",B(\"ur not supposed to be here...\"),this.userBtn.querySelector(\"svg\").innerHTML=\'<path d=\"M8 9v-4l8 7-8 7v-4h-8v-6h8zm2-7v2h12v16h-12v2h14v-20h-14z\"/>\'}},R=()=>{this[C].classList.contains(\"off\")||(this[C].classList.add(\"off\"),this[k].classList.remove(\"off\"))},B=t=>{this.loginTitle.innerHTML=\"\",this.loginTitle.appendChild(u(\"\",\"Account: \"+t)),E.textContent=this.user.login};(()=>{fetch(l+\"users/authorize\",{method:\"POST\",credentials:\"include\"}).then(async t=>{const e=await t.json();e&&e.login&&this.user.setLoggedState(e)})})(),(()=>{const t=u(\"result-msg\"),e=T.bind(null,t);v(\"closeUser\",\"X\",[\"bot--btn\"],t=>{this.userWindow.classList.add(\"off\")}),p(\"loginTitle\",[]);const n=u(\"top-bar\",[this.loginTitle,this.closeUser]);v(\"userTemplates\",{text:\"My templates\",iconPath:\"M16 0v2h-8v-2h8zm0 24v-2h-8v2h8zm2-22h4v4h2v-6h-6v2zm-18 14h2v-8h-2v8zm2-10v-4h4v-2h-6v6h2zm22 2h-2v8h2v-8zm-2 10v4h-4v2h6v-6h-2zm-16 4h-4v-4h-2v6h6v-2z\"},[\"bot-list-item\"],t=>{M(t,this.searchWindow,[\".template-menu\"]),this.editSearchParams({myTemplates:1}),this.fetchTemplates()}),v(\"logoutBtn\",{text:\"Logout\",iconPath:\"M16 9v-4l8 7-8 7v-4h-8v-6h8zm-16-7v20h14v-2h-12v-16h12v-2h-14z\"},[\"bot-list-item\",\"sign-btn\",\"icon-btn\"],t=>{this.logoutBtn.classList.add(\"inactive-btn\");fetch(\"https://bloonbot.herokuapp.com/users/logout\",{method:\"POST\",credentials:\"include\"}).then(async t=>{const n=await t.json();t.ok?(e(n.msg,!0),this.user.setLoggedState(null)):e(n.msg),this.logoutBtn.classList.remove(\"inactive-btn\")}).catch(t=>{e(t),this.logoutBtn.classList.remove(\"inactive-btn\")})});const i=u(\"user-content\",[this.userTemplates,this.logoutBtn]);c(\"userWindow\",[n,i]),this.userWindow.classList.add(\"sign-window\",\"bot-window\",\"off\"),this.userWindow.title=\"\",this.userBtn.appendChild(this.userWindow)})();let A=[this.uploadWindow,this.searchWindow];const M=(t,e,n,i=null)=>{if(t.screenX&&((t,e)=>{const n=e=>t.target.closest(e);if(Array.isArray(e)){for(let t=0;t<e.length;t++)if(n(e[t]))return!1}else if(n(e))return!1;return!0})(t,n)){i&&i();const t=A;for(let n=0;n<t.length;n++)t[n]===e||t[n].classList.contains(\"off\")||t[n].classList.add(\"off\");return e!==this[C]&&this[C].classList.add(\"off\"),!e.classList.toggle(\"off\")}return!1};window.addEventListener(\"beforeunload\",t=>{if(this.user.isLoggedIn()){const t=new Blob([JSON.stringify({name:\"__autosave__\",template:bot.text.packData(),autoSave:!0})],{type:\"application/json; charset=UTF-8\"});navigator.sendBeacon(l+\"templates\",t)}}),this.title=u(\"bot--title\",\"BloonBot v\"+bot.version,\"span\"),this.panel.appendChild(this.title);const E=u(\"login-container\"),I=u(\"user-container\",[this.userBtn,E]),N=u([\"bot--container\"],[this.hideBtn,this.sideSwitch,I]),D=u([\"bot--container\"],[N,this.title]);this.panel.appendChild(D),this.panel.appendChild(this.all),e.insertBefore(this.panel,e.firstChild),this.stylize()},handleConditsSwitch(t){this.conditsSwitch.textContent=bot.text.isConditsShown?\"conditionals >\":\"< queue\",e(this.conditsSwitch,\"toggleCondits\"),this.listForm.classList.toggle(\"unactive-form\"),this.condForm.classList.toggle(\"unactive-form\")},toggleHide(){this.isHidden?(this.hideBtn.style.setProperty(\"background\",\"red\"),this.all.style.setProperty(\"display\",\"flex\")):(this.hideBtn.style.setProperty(\"background\",\"green\"),this.all.style.setProperty(\"display\",\"none\")),this.isHidden=!this.isHidden},stylize(){const t=\"\\n                    #botPanel {\\n                        color: white;\\n                        padding: 10px;\\n                        z-index: 1000;\\n                        position: absolute;\\n                        width: 450px;\\n                        background: #000a;\\n                        box-sizing: border-box;\\n                        font-family: roboto, arial;\\n                    }\\n\\n                    #botPanel.right {\\n                        right: 0;\\n                    }\\n\\n                    #botPanel.right .bot-window {\\n                        right: 30px;\\n                        left: initial;\\n                    }\\n\\n                    .editMode {\\n                        border: 1px solid #c33;\\n                    }\\n\\n                    .update-toolbar {\\n                        display: none;\\n                        justify-content: space-between;\\n                        padding-top: 10px;\\n                        margin-top: 10px;\\n                        border-top: 1px solid #c33;\\n                    }\\n\\n                    .editMode .update-toolbar {\\n                        display: flex;\\n                    }\\n\\n                    .temp-update-label {\\n                        color: #aaa;\\n                        font-size: 0.8em;\\n                    }\\n\\n                    .temp-update-name {\\n                        font-weight: bold;\\n                    }\\n\\n                    input, textarea {\\n                        box-sizing: border-box;\\n                    }\\n                    \\n                    #botPanel label *, #botPanel label {\\n                        cursor: pointer;\\n                    }\\n                    \\n                    .top-btns {\\n                        margin-left: 10px;\\n                        fill: white;\\n                    }\\n\\n                    .side-switch {\\n                        padding: 2px !important;\\n                    }\\n\\n                    .sign-window {\\n                        top: 0;\\n                        bottom: initial !important;\\n                    }\\n\\n                    .sign-window .bot--btn {\\n                        margin-top: 10px;\\n                    }\\n\\n                    .sign-title {\\n                        display: flex;\\n                        justify-content: center;\\n                        align-items: center;\\n                        padding: 5px;\\n                        border: 2px solid #aaa;\\n                        color: #aaa;\\n                        cursor: pointer;\\n                    }\\n\\n                    .sign-title.active {\\n                        border: 2px solid white;\\n                        color: white;\\n                    }\\n\\n                    .sign-title:nth-of-type(2) {\\n                        margin-left: 5px;\\n                    }\\n\\n                    .user-content {\\n                        display: flex;\\n                        flex-flow: column;\\n                        justify-content: center;\\n                        margin-top: 8px;\\n                    }\\n\\n                    .user-container {\\n                        display: flex;\\n                        align-items: center;\\n                    }\\n\\n                    .login-container {\\n                        margin-left: 10px;\\n                        padding: 5px;\\n                    }\\n\\n                    .bot-list-item .bot-svg-icon {\\n                        margin-right: 10px;\\n                        width: 20px;\\n                        fill: #aaa;\\n                    }\\n\\n                    .update-toolbar .bot--btn .bot-svg-icon {\\n                        width: 15px;\\n                        fill: white;\\n                        margin-right: 5px;\\n                    }\\n\\n                    .update-toolbar .bot--btn {\\n                        display: flex;\\n                        align-items: center;\\n                    }\\n                    \\n                    .bot-list-item {\\n                        display: flex;\\n                        justify-content: left !important;\\n                        align-items: center;\\n                        padding: 6px;\\n                        background: none;\\n                        text-align: left;\\n                        color: white;\\n                        border: none;\\n                        border-top: 1px solid #333;\\n                        font-size: 14px;\\n                        cursor: pointer;\\n                        width: initial !important;\\n                    }\\n\\n                    .bot-list-item:hover {\\n                        background: #4449;\\n                    }\\n\\n                    .inactive-btn {\\n                        background: #666 !important;\\n                        pointer-events: none;\\n                    }\\n\\n                    .inactive-btn::after {\\n                        content: \'...\';\\n                    }\\n\\n                    .bot--btn.disabled-btn {\\n                        background: none;\\n                    }\\n\\n                    .input-container {\\n                        display: flex;\\n                        align-items: center;\\n                        justify-content: center;\\n                    }\\n\\n                    .sign-window .input-container {\\n                        margin-top: 5px;\\n                    }\\n\\n                    .input-container input {\\n                        flex: 1;\\n                        margin-left: 5px;\\n                    }\\n\\n                    .result-msg {\\n                        color: #6f6;\\n                        margin-top: 5px;\\n                    }\\n\\n                    .result-msg.wrong {\\n                        color: #f66;\\n                    }\\n\\n                    .form-input-label {\\n                        margin-top: 0 !important;\\n                    }\\n\\n                    .bot--title {\\n                        display: inline-block;\\n                        right: 10px;\\n                        color: #fff6;\\n                    }\\n\\n                    #bot--all-without-hide-btn {\\n                        display: flex;\\n                        flex-flow: column;\\n                        justify-content: center;\\n                        margin: 10px 0 0;\\n                    }\\n\\n                    .bot--list {\\n                        max-height: 20vh;\\n                        overflow: auto;\\n                    }\\n\\n                    .bot--container {\\n                        display: flex;\\n                        justify-content: space-between;\\n                        align-items: center;\\n                    }\\n\\n                    .bot--queue-item {\\n                        padding: 2px;\\n                        background: #fff9;\\n                        color: black;\\n                        border-top: 1px solid #777;\\n                        max-width: 100%;\\n                        overflow: hidden;\\n                        position: relative;\\n                        text-overflow: ellipsis;\\n                        white-space: nowrap;\\n                    }\\n\\n                    .bot--queue-item.bot--cond-item {\\n                        padding: 0px;\\n                    }\\n\\n                    .bot--list-active-el {\\n                        background: #fffc;\\n                    }\\n\\n                    .bot--list-active-el::after {\\n                        content: \'\';\\n                        position: absolute;\\n                        right: 0;\\n                        top: 0;\\n                        height: 100%;\\n                        width: 25px;\\n                        background-image: url(\\\"data:image/svg+xml,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'64\' height=\'64\' fill=\'%23f55\' viewBox=\'0 0 640 640\' shape-rendering=\'geometricPrecision\' text-rendering=\'geometricPrecision\' image-rendering=\'optimizeQuality\' fill-rule=\'evenodd\' clip-rule=\'evenodd\'%3E%3Cpath d=\'M153.581 320L486.42 640.012V-.012L153.581 320z\'/%3E%3C/svg%3E\\\");\\n                        background-position: left;\\n                    }\\n\\n                    #bot--list-control input, .bot--queue-item {\\n                        font-size: 15px;\\n                    }\\n\\n                    #bot--rate {\\n                        margin: 10px 0;\\n                        color: white;\\n                    }\\n\\n                    #bot--rate-controller {\\n                        cursor: pointer;\\n                        width: 100%;\\n                    }\\n\\n                    #bot--rate-gauge {\\n                        font-weight: bold;\\n                    }\\n\\n                    .onOffSwitches {\\n                        display: flex;\\n                        margin-bottom: 10px;\\n                    }\\n\\n                    .onOffSwitches > * {\\n                        flex: 1 0 40px;\\n                    }\\n\\n                    .bot--btn {\\n                        padding: 5px;\\n                        background: red;\\n                        color: white;\\n                        border: 2px solid white;\\n                        cursor: pointer;\\n                        font-weight: bold;\\n                    }\\n\\n                    .bot--switch {\\n                        padding: 10px;\\n                        flex: 3 0 200px;\\n                    }\\n\\n                    .bot--remove-queue {\\n                        padding: 2px 6px;\\n                    }\\n\\n                    .bot--list-control {\\n                        display: flex;\\n                        justify-content: space-between;\\n                        align-items: center;\\n                        margin: 5px 0 5px;\\n                    }\\n\\n                    .bot--expimp {\\n                        margin: 10px 0 5px;\\n                        display: flex;\\n                        justify-content: space-around;\\n                        flex-flow: column;\\n                    }\\n\\n                    .bot--expimp input[type=\'file\']{\\n                        width: 250px;\\n                        margin-left: 10px;\\n                    }\\n\\n                    .import-top {\\n                        display: flex;\\n                        justify-content: space-between;\\n                        align-items: center;\\n                        height: 30px;\\n                        margin-top: 10px;\\n                    }\\n\\n                    .bot--expimp input{\\n                        width: 100%;\\n                    }\\n\\n                    .bot--expimp .upload-window input {\\n                        width: initial;\\n                    }\\n\\n                    .bot--expimp div {\\n                        margin-top: 10px;\\n                    }\\n\\n                    .bot--import {\\n                        background: #8f8;\\n                        color: #080;\\n                    }\\n\\n                    .bot--export {\\n                        background: #f88;\\n                        color: #800;\\n                    }\\n\\n                    #bot--impSep {\\n                        width: 30px;\\n                    }\\n\\n                    #bot--expName {\\n                        width: 60px;\\n                    }\\n\\n                    .bot--export-div {\\n                        position: relative;\\n                    }\\n\\n                    .upload-btn {\\n                        background: #f88;\\n                        fill: #800;\\n                        position: absolute !important;\\n                        right: 0;\\n                        top: 0;\\n                    }\\n\\n                    .upload-content {\\n                        margin-top: 10px;\\n                    }\\n\\n                    .upload-content .input-container {\\n                        margin-bottom: 10px;\\n                    }\\n\\n                    .upload-temp {\\n                        background: #f88;\\n                        color: #800;\\n                        grid-column: 2/4;\\n                        grid-row: end;\\n                        margin-top: 10px;\\n                    }\\n\\n                    .upload-window .private-div {\\n                        display: flex;\\n                        align-items: center;\\n                        justify-content: center;\\n                    }\\n\\n                    .search-btn {\\n                        background: #8f8;\\n                        fill: #080;\\n                    }\\n                    \\n                    .search-window {\\n                        height: 500px;\\n                    }\\n\\n                    .icon-btn {\\n                        width: 30px;\\n                        height: 30px;\\n                        position: relative;\\n                        display: flex;\\n                        justify-content: center;\\n                        align-items: center;\\n                    }\\n\\n                    .icon-btn > svg {\\n                        width: 30px;\\n                    }\\n\\n                    .bot-window {\\n                        position: absolute;\\n                        left: 40px;\\n                        bottom: 30px;\\n                        background: #000c;\\n                        width: 400px;\\n                        cursor: auto;\\n                        padding: 10px;\\n                        font-weight: normal;\\n                    }\\n                    \\n                    .bot-window .top-bar {\\n                        display: flex;\\n                        justify-content: space-between;\\n                        align-items: center;\\n                        font-size: 1.2em;\\n                        font-weight: bold;\\n                    }\\n                    \\n                    .bot-window.off, .bot-unshown {\\n                        display: none;\\n                        pointer-events: none;\\n                    }\\n                    \\n                    .bot-window .close {\\n                        margin-left: 10px;\\n                    }\\n\\n                    .search-window {\\n                        display: flex;\\n                        flex-flow: column;\\n                    }\\n\\n                    .templates-result {\\n                        overflow: auto;\\n                    }\\n                    \\n                    .template {\\n                        background: #4448;\\n                        padding: 5px;\\n                        position: relative;\\n                    }\\n                    \\n                    .template-top, .template-name {\\n                        margin-top: 0px !important;\\n                    }\\n                    \\n                    .template-name {\\n                        font-weight: bold;\\n                    }\\n\\n                    .template-author {\\n                        color: #888;\\n                    }\\n\\n                    .template-peek {\\n                        color: #bbb;\\n                        white-space: nowrap;\\n                        text-overflow: ellipsis;\\n                        overflow: hidden;\\n                        margin-bottom: 5px;\\n                    }\\n\\n                    .template .result-msg {\\n                        margin-top: 0;\\n                    }\\n\\n                    .template.private .template-name svg {\\n                        width: 12px;\\n                        margin-left: 6px;\\n                        fill: white;\\n                    }\\n\\n                    .template.private {\\n                        background: #4445;\\n                    }\\n\\n                    .bot-temp-apply, .bot-temp-menu {\\n                        fill: #aaa;\\n                        position: absolute;\\n                        cursor: pointer;\\n                    }\\n                    \\n                    .bot-temp-apply {\\n                        margin: 0 5px;\\n                        right: 0;\\n                        top: 5px;\\n                    }\\n\\n                    .bot-temp-menu {\\n                        left: 0;\\n                    }\\n\\n                    .template-menu {\\n                        width: 100px;\\n                        left: 0;\\n                        top: 10px;\\n                        position: absolute;\\n                        background: #000a;\\n                        z-index: 1;\\n                    }\\n\\n                    .template-option {\\n                        margin: 0 !important;\\n                        padding: 5px 0;\\n                        border-bottom: 1px solid #555;\\n                    }\\n\\n                    textarea {\\n                        width: 100%;\\n                        resize: none;\\n                    }\\n\\n                    .bot--box-l2 {\\n                        margin-left: 20px;\\n                    }\\n\\n                    .bot--box-l3 {\\n                        margin-left: 30px;\\n                    }\\n\\n                    #botPanel label.unactive {\\n                        color: #aaa;\\n                    }\\n\\n                    .bot--condits-switch {\\n                        width: 35%;\\n                        background: #f55 !important;\\n                        margin-top: 10px;\\n                    }\\n\\n                    #botPanel .btn-on {\\n                        background: green;\\n                    }\\n\\n                    .unactive-form {\\n                        display: none;\\n                    }\\n                    \\n                    .cond-form .bot--list-control {\\n                        font-weight: bold;\\n                    }\\n                    \\n                    .cond-form input {\\n                        width: 100%;\\n                    }\\n\\n                    .bot--cond-item {\\n                        display: flex;\\n                    }\\n\\n                    .bot--cond-item > * {\\n                        width: 50%;\\n                        height: 100%;\\n                        overflow: hidden;\\n                        text-overflow: ellipsis;\\n                        white-space: nowrap;\\n                        padding: 2px;\\n                    }\\n\\n                    .then-part {\\n                        background: #f779;\\n                    }\\n\\n                    .necessary_submit {\\n                        display: none;\\n                    }\\n\\n                    .templates-modes-div {\\n                        margin-top: 10px;\\n                        display: flex;\\n                        justify-content: space-between;\\n                    }\\n\\n                    .queue-icon {\\n                        margin-right: 6px;\\n                        cursor: pointer;\\n                    }\\n\\n                    .editInput {\\n                        width: 100%;\\n                        box-sizing: border-box;\\n                    }\\n\\n                    .invalid-item {\\n                        color: white;\\n                        background: #f22;\\n                    }\\n\\n                    .begin-div {\\n                        margin-top: 10px;\\n                    }\\n                \",e=document.createElement(\"style\");e.id=\"botStyle\",e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t));const n=document.querySelector(\"#botStyle\");n&&n.remove(),document.getElementsByTagName(\"head\")[0].appendChild(e)}},text:{textArr:[\"ðŸŽˆ\"],initCondArr:[{ifs:[\"m\"],thens:[\"k\"]}],input:\"\",counter:0,oldCounter:0,msgCounter:0,isLoop:!0,isReply:!1,isReplyAll:!1,isRandom:!1,isRealType:!1,isFakeType:!1,fakeTypeRate:300,initialRate:500,itemPause:800,mode:null,msg:\"\",isConditsShown:!1,counters:[\"counter\",\"oldCounter\"],firstCondSwitch:!0,alreadyUsed:[],timesTrying:0,startChat(){const t=bot.cp.beginInput.value;t&&setTimeout(()=>{this.insertMsg(t),bot.sendMsg()},1e3)},edit(t,e){this.isConditsShown?this.condArr[t]=e:this.textArr[t]=e,this.updateList()},checkCond(){const t=this.getStrangerMsg();if(t){const e=t.trim().toLowerCase();for(let t=0;t<this.condListLength;t++){const n=this.condArr[t];let i=n.ifs[0];const s=n.thens[0];if(/^\\/[\\s\\S]*\\//.test(i))try{const n=i.replace(/^\\/|\\/$/g,\"\"),o=new RegExp(n),a=e.match(o);a&&a.length&&(this.insertMsg(s),bot.sendMsg())}catch(e){console.log(\"Invalid RegEx: \",i,e),this.markInvalid(this.condList.children[t].children[0])}else if(e===(i=i.trim().toLowerCase())){this.insertMsg(s);break}}}},markInvalid(t){t.classList.add(\"invalid-item\")},checkCounters(){for(const t of this.counters)this[t]=this[t]+1>this.listLength?0:this[t]},insert(t=!1){if(0===this.listLength)bot.stop(),alert(\"Empty queue!\");else{if(this.checkCounters(),this.isRandom&&!this.afterRandomChecked)if(t){let t=!0;t:for(let e=0;e<this.listLength;e++){const n=this.textArr[e];for(let i=0;i<this.alreadyUsed.length;i++){if(n!==this.alreadyUsed[i]){this.counter=e,t=!1;break t}}}t&&(this.alreadyUsed=[])}else this.counter=Math.floor(Math.random()*this.listLength);switch(this.mode){case\"parrot\":this.insertMsg(this.getStrangerMsg());break;case\"increment\":this.initialMsg=this.textArr[0],this.msg+=this.initialMsg,this.insertMsg(this.msg),this.msgCounter++;break;default:{const t=this.textArr[this.counter];this.insertFromQueue(t)}}this.isRandom&&(this.afterRandomChecked=!1),this.setActiveListEl()}},setActiveListEl(){this.checkCounters(),this.listLength&&(this.list.children[this.counter].classList.add(\"bot--list-active-el\"),this.oldCounter!==this.counter&&this.list.children[this.oldCounter].classList.remove(\"bot--list-active-el\"),this.oldCounter=this.counter)},insertFromQueue(t){let e=!1;this.isRandom&&!this.isLoop?(this.timesTrying++,this.timesTrying>=4?(this.timesTrying=0,this.alreadyUsed=[],this.insert()):(e=!!this.alreadyUsed.find(e=>t===e))?this.insert():this.insertMsg(t)):this.insertMsg(t),e||(this.isRandom||this.counter++,this.counter+1>this.listLength&&(this.isRandom||(this.counter=0),this.isLoop||bot.stop()),this.alreadyUsed.push(t),this.alreadyUsed.length>=this.listLength&&(this.alreadyUsed=[]))},insertMsg(t){const e=t.split(\"$msg\",2);let n=\"\";n=e.length>1?e[0]+this.getStrangerMsg()+(e[1]?e[1]:\"\"):e[0],this.input.value=n},getStrangerMsg(){const t=bot.log.querySelectorAll(\".log-stranger\");if(t.length){return t[t.length-1].textContent.replace(/Obcy:\\s/,\"\")}return\"\"},setLoop(t){this.isLoop=t},setReply(t){this.isReply=t},setReplyAll(t){this.isReplyAll=t},setRandom(t){this.isRandom=t,t&&(this.list.children[this.counter].classList.remove(\"bot--list-active-el\"),this.counter=Math.floor(Math.random()*this.listLength),this.list.children[this.counter].classList.add(\"bot--list-active-el\"),this.afterRandomChecked=!0)},setRealType(t){this.isRealType=t,t?bot.changeRate(1500,!1,!0):bot.changeRate(this.initialRate)},setFakeType(t){this.isFakeType=t,t||clearInterval(bot.fakeTypeInterval),bot.isRunning&&bot.start()},toggleCondits(t){this.isConditsShown=!t,this.presentArr=t?\"textArr\":\"condArr\",this.presentList=t?\"list\":\"condList\",this.presentListLength=t?\"listLength\":\"condListLength\",this.firstCondSwitch&&(this.updateList(),this.firstCondSwitch=!1)},realTypeSetup(){if(this.isRealType){const t=this.textArr[this.counter].length;bot.changeRate(this.initialRate/10*t+this.itemPause,!0)}},confirmListRemove(){return!(this[this.presentListLength]>1)||confirm(\"This will clear the list of messages. Proceed?\")},setTemplate(t){if(this.confirmListRemove()){let e=\"\";if(this.isConditsShown)switch(t){case\"fake k/m17\":e=[{ifs:[\"m\"],thens:[\"k\"]},{ifs:[\"k\"],thens:[\"m\"]},{ifs:[\"/.*lat.*/\"],thens:[\"17\"]},{ifs:[\"/.*m[\\\\d].*/\"],thens:[\"k17\"]},{ifs:[\"/.*k[\\\\d].*/\"],thens:[\"m17\"]},{ifs:[\"hej\"],thens:[\"hej k\"]},{ifs:[\"/^km.*/\"],thens:[\"k\"]}]}else switch(t){case\"waves\":e=[\"ðŸŽˆ\",\"ðŸŽˆðŸŽˆ\",\"ðŸŽˆðŸŽˆðŸŽˆ\",\"ðŸŽˆðŸŽˆðŸŽˆðŸŽˆ\",\"ðŸŽˆðŸŽˆðŸŽˆðŸŽˆðŸŽˆ\",\"ðŸŽˆðŸŽˆðŸŽˆðŸŽˆ\",\"ðŸŽˆðŸŽˆðŸŽˆ\",\"ðŸŽˆðŸŽˆ\",\"ðŸŽˆ\"];break;case\"BaÅ‚kanica\":e=\"BaÅ‚kaÅ„ska w Å¼yÅ‚ach pÅ‚ynie krew,| kobiety, wino, taniec, Å›piew.| Zasady proste w Å¼yciu mam,| nie rÃ³b drugiemu tego-| czego ty nie chcesz sam!| Muzyka, przyjaÅºÅ„, radoÅ›Ä‡, Å›miech.| Å»ycie Å‚atwiejsze staje siÄ™.| PrzynieÅ›cie dla mnie wina dzban,| potem ruszamy razem w tan.| BÄ™dzie! BÄ™dzie zabawa!| BÄ™dzie siÄ™ dziaÅ‚o!| I znowu nocy bÄ™dzie maÅ‚o.| BÄ™dzie gÅ‚oÅ›no, bÄ™dzie radoÅ›nie| ZnÃ³w przetaÅ„czymy razem caÅ‚Ä… noc.| BÄ™dzie! BÄ™dzie zabawa!| BÄ™dzie siÄ™ dziaÅ‚o!| I znowu nocy bÄ™dzie maÅ‚o.| BÄ™dzie gÅ‚oÅ›no, bÄ™dzie radoÅ›nie| ZnÃ³w przetaÅ„czymy razem caÅ‚Ä… noc.| Orkiestra nie oszczÄ™dza siÅ‚| juÅ¼ trochÄ™ im brakuje tchu.| Polejcie wina rÃ³wnieÅ¼ im| znÃ³w na parkiecie bÄ™dzie dym.| BaÅ‚kaÅ„skie rytmy, Polska moc!| ZnÃ³w przetaÅ„czymy caÅ‚Ä… noc.| I jeszcze jeden malutki wina dzban| i znÃ³w ruszymy razem w tan!| BÄ™dzie! BÄ™dzie zabawa!| BÄ™dzie siÄ™ dziaÅ‚o!| I znowu nocy bÄ™dzie maÅ‚o.| BÄ™dzie gÅ‚oÅ›no, bÄ™dzie radoÅ›nie| ZnÃ³w przetaÅ„czymy razem caÅ‚Ä… noc.| BÄ™dzie! BÄ™dzie zabawa!| BÄ™dzie siÄ™ dziaÅ‚o!| I znowu nocy bÄ™dzie maÅ‚o.| BÄ™dzie gÅ‚oÅ›no, bÄ™dzie radoÅ›nie| ZnÃ³w przetaÅ„czymy razem caÅ‚Ä… noc.|\".split(\"|\")}this.mutateTextArr(e)}bot.cp.select.value=\"NONE\"},setMode(t,e=!1){if(\"parrot\"===t){this.mode=\"parrot\";const t=bot.cp.replyBox;t.checked||t.click()}else this.mode=\"NONE\"!==t?t:null;e&&(bot.cp.selectMode.value=t),this.reset()},mutateTextArr(t,e=!1){e?this[\"queue\"===e?\"textArr\":\"condArr\"]=t:this[this.presentArr]=t,this.updateList(e)},addMessage(t){if(t){let e=\"\";e=this.isConditsShown?t:t.replace(/\\s/g,\" \");const n=[...this[this.presentArr],e];this.mutateTextArr(n)}},removeMessage(t){t=parseInt(t),this[this.presentArr].splice(t,1),this.isConditsShown||(0!==this.counter&&t!==this.counter&&t<this.counter?this.counter-=1:t===this.counter&&this.reset()),this.updateList()},removeQueue(){this.confirmListRemove()&&this.mutateTextArr(this.isConditsShown?[...this.initCondArr]:[\"ðŸŽˆ\"])},updateListItem(t){if(this.isConditsShown){const e=this.condList.children[t];if(e){e.innerHTML=\"\";const n=this.createListItem(this[this.presentArr][t]);e.appendChild(n)}}else{const e=this.list.children[t];if(e){e.innerHTML=\"\";const n=this.createListItem(this[this.presentArr][t]);e.appendChild(n)}}},createListItem(t,e=null,n=!1){if(n?\"queue\"!==n:this.isConditsShown){let n=null;\"number\"!=typeof e?n=document.createDocumentFragment():((n=document.createElement(\"div\")).dataset.id=e,n.classList.add(\"bot--queue-item\",\"bot--cond-item\"));const i=document.createElement(\"div\"),s=document.createElement(\"div\");i.classList.add(\"if-part\"),s.classList.add(\"then-part\");const r=a.cloneNode(!0),d=o.cloneNode(!0),h=d.cloneNode(!0),c=l.cloneNode(!0);return i.appendChild(c),i.appendChild(r),i.appendChild(d),s.appendChild(h),i.appendChild(document.createTextNode(t.ifs[0])),s.appendChild(document.createTextNode(t.thens[0])),n.appendChild(i),n.appendChild(s),n}{let n=null;\"number\"!=typeof e?n=document.createDocumentFragment():((n=document.createElement(\"div\")).dataset.id=e,n.classList.add(\"bot--queue-item\"));const i=document.createTextNode(t),s=o.cloneNode(!0),r=a.cloneNode(!0),d=l.cloneNode(!0);return n.appendChild(d),n.appendChild(r),n.appendChild(s),n.appendChild(i),n}},updateList(t=!1){if(t?\"queue\"!==t:this.isConditsShown){this.condList.innerHTML=\"\";const e=document.createDocumentFragment();this.condArr.map((n,i)=>{const s=this.createListItem(n,i,t);e.appendChild(s)}),this.condList.appendChild(e),this.condListLength=this.condArr.length}else{this.list.innerHTML=\"\";const e=document.createDocumentFragment();this.textArr.map((n,i)=>{if(n&&\" \"!==n&&\"\\n\"!==n){const s=this.createListItem(n,parseInt(i),t);e.appendChild(s)}else this.textArr.splice(i,0);this.list.appendChild(e)}),this.listLength=this.textArr.length,this.checkCounters(),this.setActiveListEl()}},reset(){this.isConditsShown||(this.listLength&&(this.checkCounters(),this.list.children[this.counter+1>this.listLength?0:this.counter].classList.remove(\"bot--list-active-el\"),this.list.children[0].classList.add(\"bot--list-active-el\")),this.counter=this.oldCounter=this.msgCounter=0,this.msg=\"\")},packData(){return{settings:{boxes:{isLoop:this.isLoop,isReply:this.isReply,isReplyAll:this.isReplyAll,isRandom:this.isRandom,isRealType:this.isRealType,isFakeType:this.isFakeType},switches:{queue:bot.isQueueRunning,conds:bot.isCondsRunning},rate:bot.rate,mode:this.mode,begin:bot.cp.beginInput.value},textArr:this.textArr,condArr:this.condArr}},export(t){const e=this.packData();n(JSON.stringify(e),(t||this.textArr[0])+\".json\",\"text/plain\")},import(t,e,n=!1){if(console.log(e),\"string\"==typeof e)(e=>{\"\\\\n\"===t&&(t=\"\\n\");const n=e.split(t);this.mutateTextArr(n)})(e);else{const t=t=>{if(!t)return void alert(\"Unable to apply template. Not enough template data.\");this.mutateTextArr(t.textArr,\"queue\"),this.mutateTextArr(t.condArr,\"conds\");const e=Object.keys(t.settings.boxes),n=Object.values(t.settings.boxes),i=bot.cp;for(let t=0;t<e.length;t++){const s=e[t],o=n[t];if(this[s]!==o){i[s.slice(2,3).toLowerCase()+s.slice(3)+\"Box\"].click()}}const s=t.settings.begin;bot.cp.beginInput.value=s||\"\",bot.changeRate(t.settings.rate,!1,!0),this.setMode(t.settings.mode,!0);const o=t.settings.switches;bot.onOffSpecific(\"queue\",o.queue),bot.onOffSpecific(\"conds\",o.conds)};if(n)return void t(e);const o=e=>{const n=e.target.result,i=JSON.parse(n);t(i)};if(!window.FileReader)return alert(\"Your browser is not supported\"),!1;var i=new FileReader;if(e.length){var s=e[0];i.readAsText(s),i.addEventListener(\"load\",o)}else alert(\"Please upload a file or enter some text before continuing\")}},init(){this.input=bot.inp,this.list=bot.cp.list,this.listLength=this.list.length,this.condList=bot.cp.condList,this.initialRate=bot.rate,this.condArr=this.initCondArr,this.presentArr=\"textArr\",this.presentList=\"list\",this.presentListLength=\"listLength\",setTimeout(()=>{this.updateList()},0)}},start(){if(this.stop(),this.cp.btn.style.setProperty(\"background\",\"green\"),this.text.realTypeSetup(),this.isQueueRunning&&this.text.isFakeType){let t=1;this.fakeTypeInterval=setInterval(()=>{++t>3&&(t=1);let e=\"Faking typing.\";switch(t){case 2:e+=\".\";break;case 3:e+=\"..\"}this.text.insertMsg(e)},this.text.fakeTypeRate)}this.botInterval=setInterval(()=>{this.runSetup()},this.rate),this.isRunning=!0},stop(){this.isRunning&&(this.cp.btn.style.setProperty(\"background\",\"red\"),clearInterval(this.botInterval),clearInterval(this.fakeTypeInterval),this.botInterval=0,this.fakeTypeInterval=0,this.isRunning=!1)},isLastMsgStrangers(){const t=this.log.lastChild;return!!t&&t.classList.contains(this.strangerMsgClass)},runSetup(){if(this.isCondsRunning&&(this.text.isReply?this.isLastMsgStrangers()&&this.text.checkCond():this.text.checkCond()),this.isQueueRunning){if(this.text.isReply)try{(this.isLastMsgStrangers()||this.text.isReplyAll&&this.text.counter>0)&&(this.text.insert(),this.sendMsg())}catch(t){}else this.text.insert(),this.sendMsg();this.isFirstRun=!1,this.text.isRealType&&this.start()}},sendMsg(){this.btn.click();const t=document.querySelector(\".sd-interface button\");t&&t.click()},leaveIfDisconnected(){this.btn.classList.contains(\"disabled\")&&this.isAutoNext&&(this.btnEsc.click(),this.text.isRandom||this.text.reset(),this.text.startChat())},toggle(){this.isRunning?this.stop():(this.runSetup(),this.start(),this.isFirstRun=!0)},changeRate(t,e=!1,n=!1){if(this.rate=t,!e){this.text.initialRate=t;const e=this.rate<1e3?Math.floor(this.rate)+\"ms\":(this.rate/1e3).toFixed(1)+\"s\";this.cp.rateGauge.textContent=e}n&&(this.cp.rateController.value=t),this.isRunning&&this.start()},toggleAutoNext(){this.isAutoNext?this.cp.btnAutoNext.style.setProperty(\"background\",\"red\"):this.cp.btnAutoNext.style.setProperty(\"background\",\"green\"),this.isAutoNext=!this.isAutoNext},onOffSpecific(t=\"queue\",e=null){const n=\"queue\"===t?\"queueBtn\":\"conditsBtn\",i=\"queue\"===t?\"isQueueRunning\":\"isCondsRunning\";e!==this[i]&&(this.cp[n].classList.toggle(\"btn-on\"),this[i]=!this[i],this.isRunning&&this.start())},init(t,e=null,n=null,i=null,s=null){this.btn=e?document.querySelector(e):null,this.btnEsc=n?document.querySelector(n):null,this.inp=t?document.querySelector(t):null,this.log=i?document.querySelector(i):null,this.strangerMsgClass=s,setInterval(()=>{this.isRunning&&this.leaveIfDisconnected()},1e3),this.cp.init(),this.text.init()}};window.bot=bot}bot.init(\"#box-interface-input\",\"button.o-any.o-send\",\"button.o-any.o-esc\",\"#log-dynamic\",\"log-stranger\");'

#######################################################################
# !!!!!!!!!!!!! BEFORE EXEing CHECK "fastmode", "noinstall"

import tkinter as tk
window = tk.Tk()
keyb = Controller()

import re
# from tqdm import tqdm_gui

# def find_file(root_folder, rex):
#     for root,dirs,files in os.walk(root_folder):
#         for f in files:
#             result = re.search(rex, f)
#             if result:
#                 return os.path.join(root, f)

def find_folder(root_folder, rex):
    # for root,dirs,files in tqdm_gui(os.walk(root_folder), total=):
    for root,dirs,files in os.walk(root_folder): # ,files
        for d in dirs:
            result = re.search(rex, d)
            if result:
                print(result)
                return os.path.join(root, d)

# path = find_folder('C:\\', '^Mozilla Firefox$')
# print(path)

import psutil

def isProcessRunning(processName):
    return processName in (p.name() for p in psutil.process_iter())

# browserPaths = {
#     'firefox': r'C:\Program Files\Mozilla Firefox\firefox.exe',
#     'chrome': r'C:\Program Files (x86)\Google\Chrome\Application\chrome.exe',
#     'chrome2': r'C:\Program Files\Google\Chrome\Application\chrome.exe'
# }

def openTab(browser = 'firefox'):
    if browser == 'firefox':
        path = find_folder('C:\\', '^Mozilla Firefox$')
        fullPath = path + '\\firefox.exe'
        print(fullPath)
        subprocess.call([fullPath, '-new-tab', siteUrl])
    elif browser == 'chrome':
        path = find_folder('C:\\', '^Chrome$')
        subprocess.call([path+'\\chrome.exe', '-new-tab', siteUrl])

    return browser

    
import pygetwindow as gw

def focusWindow(title):
    try:
        browserWindow = gw.getWindowsWithTitle(title)[0]
        browserWindow.activate()
        if not fastMode: time.sleep(0.5)
        browserWindow.maximize()
        if not fastMode: time.sleep(0.5)
        return True
    except:
        return False

#######################################################################

# for i in tqdm_gui(range(100)):
#     time.sleep(0.1)

# zezwalaj na wklejanie do firefoxa
fastMode = False #!!!!!!!!!!!!!!!!!!!!!!!!
noInstall = False
fastModeSpeed = 1

if not noInstall:
    from tkinter import messagebox

    website = '6obcy'
    msgWindowsEnabled = True

    window.eval('tk::PlaceWindow %s center' % window.winfo_toplevel())
    window.withdraw()
    def messageWindow(type, title, msg):
        if(msgWindowsEnabled):
            if type == 'error':
                messagebox.showerror(title, msg)
            elif type == 'warning':
                messagebox.showwarning(title, msg)
            else:
                messagebox.showinfo(title, msg)

    sites = {
        '6obcy': 'https://6obcy.org/rozmowa',
        'e-chat.co': 'echaturl',
        'test': 'https://6obcy.org'
    }
    siteUrl = sites.get(website, None)

    firefoxFound = True

    if siteUrl is None:
        messageWindow('error', 'BloonBot launcher', 'No such website available')
    else:
        messageWindow('warning' ,'BloonBot launcher', 'Bot installation works best on Firefox. \n Do not use your mouse after you confirm this window. \n Installing will take about 30 seconds.')
        isFirefoxRunning = isProcessRunning('firefox.exe')
        isChromeRunning = isProcessRunning('chrome.exe')
        if not fastMode: time.sleep(2)

        try:
            if isFirefoxRunning:
                launchedBrowser = openTab('firefox')
            elif isChromeRunning:
                launchedBrowser = openTab('chrome')
            else:
                launchedBrowser = openTab('firefox')
        except:
            try:
                launchedBrowser = openTab('chrome')
            except:
                webbrowser.open_new(siteUrl)
                launchedBrowser = 'chrome'
                # firefoxFound = False
                # messageWindow('error', 'BloonBot launcher', 'Firefox or Chrome can not be found.')
                # sys.exit()
                # webbrowser.open_new(siteUrl)
            firefoxFound = False
            
        if launchedBrowser == 'firefox':
            sleeps = {
                'browserLoad': 7,
                'consoleOpen': 3,
                'paste': 2,
                'codeLaunch': 2,
                'consoleClose': 2,
                'firefoxBeforePasteConfirm': 1,
                'keyPressTime': 0.5
            }
            if not isFirefoxRunning:
                sleeps['browserLoad'] = 10
        else:
            sleeps = {
                'browserLoad': 10,
                'consoleOpen': 7,
                'paste': 3,
                'codeLaunch': 3,
                'consoleClose': 2,
                'keyPressTime': 0.5
            }
            if not isChromeRunning:
                sleeps['browserLoad'] = 14

        if fastMode:
            for k, v in sleeps.items():
                sleeps[k] = fastModeSpeed
                if k == 'keyPressTime':
                    sleeps[k] = 0.1
        
        tooLongWait = False
        i = 0
        while not isProcessRunning(launchedBrowser+'.exe'):
            print(i)
            i+=1
            if(i > 15):
                tooLongWait = True
                break
            time.sleep(1)

        if not tooLongWait: time.sleep(sleeps['browserLoad'])
        # pyautogui.click(500, 400)
        focusWindow(launchedBrowser)
        # time.sleep(sleeps['focus'])
        with keyb.pressed(Key.ctrl):
            with keyb.pressed(Key.shift):
                if launchedBrowser == 'firefox': consoleKey = 'k' # firefox
                else: consoleKey = 'j' #chrome

                keyb.press(consoleKey)
                time.sleep(sleeps['consoleOpen'])
                keyb.release(consoleKey)

        pyperclip.copy(botCode)

        if launchedBrowser == 'firefox':
            time.sleep(sleeps['firefoxBeforePasteConfirm'])
            pyautogui.typewrite('zezwalaj na wklejanie', interval=0.02)
            pyautogui.hotkey('ctrl', 'a')

        time.sleep(sleeps['paste']) # pasting code after console is open
        focusWindow(launchedBrowser)
        keyb.press(Key.ctrl)
        keyb.press('v')
        time.sleep(sleeps['keyPressTime'])
        keyb.release(Key.ctrl)
        keyb.release('v')

        time.sleep(sleeps['codeLaunch']) # pressing enter after pasting code to console
        focusWindow(launchedBrowser)
        keyb.press(Key.enter)
        time.sleep(sleeps['keyPressTime'])
        keyb.release(Key.enter)

        time.sleep(sleeps['consoleClose']) # closing console after pressing enter
        focusWindow(launchedBrowser)
        keyb.press(Key.f12)
        time.sleep(sleeps['keyPressTime'])
        keyb.release(Key.f12)
        if firefoxFound:
            messageWindow('info', 'BloonBot launcher', 'BloonBot has been installed. You can safely use your mouse now.')
        else:
            messageWindow('warning', 'BloonBot launcher', 'Firefox/Chrome not found. If bot is not correctly installed install one of these browsers and try again.')

    window.deiconify()
    window.destroy()
    window.quit()